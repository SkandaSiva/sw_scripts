!function(){"use strict";const t=new URL(self.location.href).searchParams,n=new URL(t.get("asset-url"),self.location.href).href;function e(t){return`${n}assets/${t}`}self.addEventListener("push",(t=>{const n=t.data.json();return t.waitUntil(self.registration.showNotification(n.title,{badge:e("logo/lishogi-mono-128.png"),icon:e("logo/lishogi-favicon-192.png"),body:n.body,tag:n.tag,data:n.payload,requireInteraction:!0}))})),self.addEventListener("notificationclick",(t=>t.waitUntil(async function(t){(await self.registration.getNotifications()).forEach((t=>t.close()));const n=await self.clients.matchAll({type:"window",includeUncontrolled:!0}),e=t.notification.data.userData;let a="/";e.fullId?a="/"+e.fullId:e.threadId?a="/inbox/"+e.threadId:e.challengeId&&(a="/"+e.challengeId);for(const o of n)if(new URL(o.url,self.location.href).pathname===a&&"focus"in o)return await o.focus();for(const o of n)if("/"===new URL(o.url,self.location.href).pathname)return await o.navigate(a);return await self.clients.openWindow(a)}(t))))}();
