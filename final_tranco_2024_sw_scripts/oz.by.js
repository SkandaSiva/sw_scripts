importScripts('https://www.gstatic.com/firebasejs/10.3.1/firebase-app-compat.js');importScripts('https://www.gstatic.com/firebasejs/10.3.1/firebase-messaging-compat.js');firebase.initializeApp({apiKey:"AIzaSyAQKsxFGbyUsbh9WReiCzPGcznmKRwsHEg",authDomain:"ozby-ec330.firebaseapp.com",databaseURL:"https://ozby-ec330.firebaseio.com",projectId:"ozby-ec330",storageBucket:"ozby-ec330.appspot.com",messagingSenderId:"944969210921",appId:"1:944969210921:web:4e01f907398b902e745038",measurementId:"G-SZS3THSKQ8"});const messaging=firebase.messaging();messaging.onBackgroundMessage((payload)=>{options={data:payload.data,body:payload.data.body,icon:payload.data.icon,};if(payload.data.image){options.image=payload.data.image;}
if(payload.data.actions){options.actions=JSON.parse(payload.data.actions);}
sendMessageLog(payload.data.id_message,'show');return self.registration.showNotification(payload.data.title,options);});self.addEventListener('notificationclick',function(event){const target=event.notification.data.click_action||'/';event.notification.close();sendMessageLog(event.notification.data.id_message,'click')
event.waitUntil(clients.matchAll({type:"window"}).then(function(clientList){for(var i=0;i<clientList.length;i++){var client=clientList[i];if(client.url==target&&'focus'in client)
return client.focus();}
if(clients.openWindow)
return clients.openWindow(target);}));});function sendMessageLog(messageId,action){var data=new FormData();data.append('messageId',messageId);data.append('action',action);return fetch('/personal/ajax/push/messageLog.php',{method:"POST",body:data,});};