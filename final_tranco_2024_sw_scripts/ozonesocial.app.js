let NO_CACHING=false;let CACHE_STATIC_NAME="ozone_static_assets_v0.0.12";let CACHE_DYNAMIC_NAME="ozone_dynamic_assets_v0.0.12";let STATIC_FILES=["/fonts/iranYekanX/IRANYekanX_Regular.woff2","/fonts/iranYekanX/IRANYekanX_Medium.woff2","/fonts/iranYekanX/IRANYekanX_Bold.woff2","/ozon_favicon.png",];self.addEventListener("install",function(event){console.log("[Service Worker] Installing Service Worker ...");if(!NO_CACHING){event.waitUntil(caches.open(CACHE_STATIC_NAME).then(function(cache){console.log("[service worker] precaching App Shell");cache.addAll(STATIC_FILES);}));}});self.addEventListener("activate",function(event){console.log("[Service Worker] Activating Service Worker ....");event.waitUntil(caches.keys().then(function(keyList){return Promise.all(keyList.map(function(key){if(key!==CACHE_STATIC_NAME&&key!==CACHE_DYNAMIC_NAME){console.log("[Service Worker] Removing old cache.");return caches.delete(key);}else{return key;}}));}));return self.clients.claim();});function isInArray(string,array){let cachePath;if(string.indexOf(self.origin)===0){cachePath=string.substring(self.origin.length);}else{cachePath=string;}return array.indexOf(cachePath)>-1;}self.addEventListener("fetch",function(event){if(NO_CACHING){return event.respondWith(fetch(event.request));}else{const localUrl="http://localhost:4200/images";const devUrl="https://o3social.app/images";const proUrl="https://ozonesocial.app/images";const restOfUrls=!event.request.url.startsWith(localUrl)&&!event.request.url.startsWith(devUrl)&&!event.request.url.startsWith(proUrl);if(restOfUrls){event.respondWith(fetch(event.request).catch(function(err){console.log("### catch offline",err);}));}else if(isInArray(event.request.url,STATIC_FILES)){event.respondWith(caches.match(event.request));}else{event.respondWith(caches.match(event.request).then(function(response){if(response){return response;}else{return fetch(event.request).then(function(res){return caches.open(CACHE_DYNAMIC_NAME).then(function(cache){cache.put(event.request.url,res.clone());return res;}).catch(function(err){console.log("### open catch and put",err);});}).catch(function(err){console.log("### catch offline",err);});}}));}}});