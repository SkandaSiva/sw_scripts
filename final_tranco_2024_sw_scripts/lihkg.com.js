importScripts('https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js');importScripts('https://www.gstatic.com/firebasejs/7.15.5/firebase-messaging.js');firebase.initializeApp({apiKey:'AIzaSyDxXWasuuuwE9vOhDoernkFObHAwMJUW_c',projectId:'lihkg-app',messagingSenderId:'567293641492',appId:'1:567293641492:web:af06299ef5328af7e7b801',});const messaging=firebase.messaging();messaging.setBackgroundMessageHandler(function(payload){if(!payload.data.meta)return
const meta=JSON.parse(payload.data.meta);const notificationTitle=meta.title||'來自 LIHKG 的通知';const notificationOptions={body:meta.body||'有新通知',icon:'https://cdn.lihkg.com/assets/images/logo-256.png',data:meta,};return self.registration.showNotification(notificationTitle,notificationOptions);});self.addEventListener('notificationclick',function(event){event.notification.close();event.waitUntil(self.clients.openWindow(event.notification.data.click_action||'https://lihkg.com'));});