self.addEventListener("install",function(A){A.waitUntil(self.skipWaiting())});self.addEventListener("activate",function(A){A.waitUntil(self.clients.claim())});var payload;function getFormattedDate(A){try{A=A||new Date();var G=(A.getHours()<10)?"0"+A.getHours():A.getHours(),B=(A.getMinutes()<10)?"0"+A.getMinutes():A.getMinutes(),H=(A.getSeconds()<10)?"0"+A.getSeconds():A.getSeconds(),E=((A.getMonth()+1)<10)?"0"+(A.getMonth()+1):(A.getMonth()+1),C=(A.getMilliseconds()<10)?"00"+A.getMilliseconds():((A.getMilliseconds()<100)?"0"+A.getMilliseconds():A.getMilliseconds()),F=G+":"+B+":"+H+"."+C,I=(A.getDate()<10)?"0"+A.getDate():A.getDate();return A.getFullYear()+"-"+E+"-"+I+" "+F}catch(D){}}function getRequestPayload(B,A){return{appType:"WEB",eventTypes:[{eventType:"render",eventName:A,timestamp:getFormattedDate(),eventValuesV2:B}],orgId:"1001_1"}}self.addEventListener("push",function(D){self.clients.matchAll().then(function(G){G.forEach(function(H){H.postMessage(JSON.stringify({type:"trigger",value:null}))})});if(D.data){payload=JSON.parse(D.data.text())}if(payload){var E={redirectUrl:payload.lk};var F={body:payload.ct,icon:"https://n1.sdlcdn.com/imgs/g/4/6/sdlogoweb-d3fb7.jpg",image:payload.img,tag:payload.tag,data:E,requireInteraction:true};var C=self.registration.showNotification(payload.hd,F);var A=[{journeyId:payload.jid.toString()||"",title:encodeURIComponent(payload.hd)||"",stateId:payload.state.toString()||"",ecaId:payload.ecaid.toString()||"",imgUrl:payload.img||"",isSilent:payload.s,testId:payload.testid.toString()||"",campaignId:"",communicationMode:"BROWSER"}];var B=getRequestPayload(A,"notificationReceivedSys");fetch("https://log.snapdeal.com/getEventData?event="+JSON.stringify(B)).then(function(G){});return D.waitUntil(C)}});self.addEventListener("notificationclick",function(C){C.notification.close();try{if(!self.payload&&C.target&&C.target.payload){payload=C.target.payload}var A=[{journeyId:payload.jid.toString()||"",title:encodeURIComponent(payload.hd)||"",campaignName:"",stateId:payload.state.toString()||"",ecaId:payload.ecaid.toString()||"",testId:payload.testid.toString()||"",campaignId:"",rawUrl:encodeURIComponent(payload.lk),communicationMode:"BROWSER"}];var B=getRequestPayload(A,"notificationClickSys");fetch("https://log.snapdeal.com/getEventData?event="+JSON.stringify(B)).then(function(E){})}catch(D){console.log(D)}C.waitUntil(clients.openWindow(C.notification.data?C.notification.data.redirectUrl:"/"))});
