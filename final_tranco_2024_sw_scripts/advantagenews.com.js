importScripts('https://www.gstatic.com/firebasejs/6.6.2/firebase-app.js');importScripts('https://www.gstatic.com/firebasejs/6.6.2/firebase-messaging.js');const oFirebase = firebase.initializeApp({messagingSenderId: '568686099514'}, 'tncms-notifier');self.addEventListener('notificationclick', oEvent => {var oData = oEvent.notification.data.FCM_MSG.data;let oURL = new URL(oData.url);if (oData.utm_source && oData.utm_medium && oData.utm_campaign) { oURL.searchParams.set('utm_source', oData.utm_source); oURL.searchParams.set('utm_medium', oData.utm_medium); oURL.searchParams.set('utm_campaign', oData.utm_campaign);}oEvent.notification.close();oEvent.waitUntil(self.clients.matchAll({type: 'window'}).then(function(oList) {for (var i = 0; i < oList.length; i++) {var oClient = clientList[i];if (oClient.url == oURL.toString() && 'focus' in oClient) {return oClient.focus();}}if (self.clients.openWindow) {return self.clients.openWindow(oURL.toString());}}));});const messaging = firebase.messaging(oFirebase);messaging.setBackgroundMessageHandler(oPayload => {let oNotify = {};if (oPayload.body) {oNotify.body = oPayload.body;}if (oPayload.data) {if (oPayload.data.icon) {oNotify.icon = oPayload.data.icon;}if (oPayload.data.tag) { oNotify.tag = oPayload.data.tag;}oNotify.data = oPayload.data;}return self.registration.showNotification(oPayload.title, oNotify);});