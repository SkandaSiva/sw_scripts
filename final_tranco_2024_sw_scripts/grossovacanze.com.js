function toQueryString(n){var e=[];for(var t in n)t in n&&e.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e.join("&")}self.addEventListener("install",(function(n){n.waitUntil(self.skipWaiting()),console.log("The ServiceWorker was installed.")})),self.addEventListener("activate",(function(){console.log("The ServiceWorker was activated.")})),self.addEventListener("push",(function(n){var e,t;console.log("Received a new push message",n),n.waitUntil(self.registration.pushManager.getSubscription().then((function(i){return e="Web",t=i.endpoint,n.data.json()})).then((function(n){return n instanceof Response?n.ok?n.json():{title:"",message:"A new post has been published.",id:0}:n})).then((function(n){return self.registration.showNotification(n.title,{body:n.message,icon:n.icon||"pnfw/icon/",tag:self.registration.scope,requireInteraction:!0,data:{id:n.id,token:t,os:e}})})))})),self.addEventListener("notificationclick",(function(n){console.log("On notification click: ",n.notification.tag),n.notification.close();var e={os:n.notification.data.os,token:n.notification.data.token,post:n.notification.data.id};if(clients.openWindow)return clients.openWindow("pnfw/goto/?"+toQueryString(e))}));