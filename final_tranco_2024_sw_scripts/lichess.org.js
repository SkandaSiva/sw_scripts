var r=new URL(self.location.href).searchParams,c=new URL(r.get("asset-url"),self.location.href).href;function s(e){return`${c}assets/${e}`}self.addEventListener("push",e=>{let a=e.data.json();return e.waitUntil(self.registration.showNotification(a.title,{badge:s("logo/lichess-mono-128.png"),icon:s("logo/lichess-favicon-192.png"),body:a.body,tag:a.tag,data:a.payload,requireInteraction:!0}))});async function f(e){(await self.registration.getNotifications()).forEach(i=>i.close());let o=await self.clients.matchAll({type:"window",includeUncontrolled:!0}),t=e.notification.data.userData,n=t.path||"/";t.fullId?n="/"+t.fullId:t.threadId?n="/inbox/"+t.threadId:t.challengeId?n="/"+t.challengeId:t.streamerId?n=`/streamer/${t.streamerId}/redirect`:t.mentionedBy?n=`/forum/redirect/post/${t.postId}`:t.invitedBy&&(n=`/study/${t.studyId}`);for(let i of o)if(new URL(i.url,self.location.href).pathname===n&&"focus"in i)return await i.focus();for(let i of o)if(new URL(i.url,self.location.href).pathname==="/")return await i.navigate(n);return await self.clients.openWindow(n)}self.addEventListener("notificationclick",e=>e.waitUntil(f(e)));
