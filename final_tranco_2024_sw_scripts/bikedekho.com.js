var _connectoSW={version:2,logging:!0,writeKey:"Q3B1q3vQULiMC96G",apiUrl:"https://api.connecto.io",pushUrl:"https://push.connecto.io",VAPID:"BLnQfPBVfjUc_uztGQHY805I97diS6uFqQOuELjQwTZXqSYNHRZCHBgxgcAKi39ft51E8U04T3HD9zAFpw0jto4"};(t=>{function e(n){return caches.match(n).then(function(e){return e?(e.type,e):fetch(n,{mode:"cors",credentials:"omit"}).then(function(e){var t;return e&&e.ok?(t=e.clone(),caches.open("assets-bd-v2").then(function(e){e.put(n,t)})):(t=e.clone(),caches.open("assets-bd-v2").then(function(e){e.put(n,t)})),e})})}!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).toolbox=e()}(function(){return function o(r,i,c){function a(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n=i[t]={exports:{}};r[t][0].call(n.exports,function(e){return a(r[t][1][e]||e)},n,n.exports,o,r,i,c)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<c.length;e++)a(c[e]);return a}({1:[function(e,t,n){function a(e,t){((t=t||{}).debug||s.debug)&&console.log("[sw-toolbox] "+e)}function i(e){var t=(t=e&&e.cache?e.cache.name:t)||s.cache.name;return caches.open(t)}function o(e){var t=Array.isArray(e);if(t&&e.forEach(function(e){"string"==typeof e||e instanceof Request||(t=!1)}),t)return e;throw new TypeError("The precache method expects either an array of strings and/or Requests or a Promise that resolves to an array of strings and/or Requests.")}var c,s=e("./options"),u=e("./idb-cache-expiration");t.exports={debug:a,fetchAndCache:function(o,r){var t=(r=r||{}).successResponses||s.successResponses;return fetch(o.clone()).then(function(e){return"GET"===o.method&&t.test(e.status)&&i(r).then(function(n){n.put(o,e).then(function(){var e,t=r.cache||s.cache;(t.maxEntries||t.maxAgeSeconds)&&t.name&&(e=function(e,t,n){var o=e.url,r=n.maxAgeSeconds,i=n.maxEntries,e=n.name,c=Date.now();return a("Updating LRU order for "+o+". Max entries is "+i+", max age is "+r),u.getDb(e).then(function(e){return u.setTimestampForUrl(e,o,c)}).then(function(e){return u.expireEntries(e,i,r,c)}).then(function(e){a("Successfully updated IDB.");e=e.map(function(e){return t.delete(e)});return Promise.all(e).then(function(){a("Done with cache cleanup.")})}).catch(function(e){a(e)})}.bind(null,e=o,n,t),c=c?c.then(e):e())})}),e.clone()})},openCache:i,renameCache:function(t,e,n){return a("Renaming cache: ["+t+"] to ["+e+"]",n),caches.delete(e).then(function(){return Promise.all([caches.open(t),caches.open(e)]).then(function(e){var n=e[0],o=e[1];return n.keys().then(function(e){return Promise.all(e.map(function(t){return n.match(t).then(function(e){return o.put(t,e)})}))}).then(function(){return caches.delete(t)})})})},cache:function(t,e){return i(e).then(function(e){return e.add(t)})},uncache:function(t,e){return i(e).then(function(e){return e.delete(t)})},precache:function(e){e instanceof Promise||o(e),s.preCacheItems=s.preCacheItems.concat(e)},validatePrecacheInput:o,isResponseFresh:function(e,t,n){if(!e)return!1;if(t){e=e.headers.get("date");if(e&&new Date(e).getTime()+1e3*t<n)return!1}return!0}}},{"./idb-cache-expiration":2,"./options":4}],2:[function(e,t,n){var r="sw-toolbox-",i=1,u="store",l="url",f="timestamp",c={};t.exports={getDb:function(e){return e in c||(c[e]=(o=e,new Promise(function(e,t){var n=indexedDB.open(r+o,i);n.onupgradeneeded=function(){n.result.createObjectStore(u,{keyPath:l}).createIndex(f,f,{unique:!1})},n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}}))),c[e];var o},setTimestampForUrl:function(o,r,i){return new Promise(function(e,t){var n=o.transaction(u,"readwrite");n.objectStore(u).put({url:r,timestamp:i}),n.oncomplete=function(){e(o)},n.onabort=function(){t(n.error)}})},expireEntries:function(e,n,t,o){return c=e,s=o,((a=t)?new Promise(function(e,t){var n=1e3*a,o=[],r=c.transaction(u,"readwrite"),i=r.objectStore(u);i.index(f).openCursor().onsuccess=function(e){var t,e=e.target.result;e&&s-n>e.value[f]&&(t=e.value[l],o.push(t),i.delete(t),e.continue())},r.oncomplete=function(){e(o)},r.onabort=t}):Promise.resolve([])).then(function(t){return a=e,((s=n)?new Promise(function(e,t){var o=[],n=a.transaction(u,"readwrite"),r=n.objectStore(u),i=r.index(f),c=i.count();i.count().onsuccess=function(){var n=c.result;s<n&&(i.openCursor().onsuccess=function(e){var t,e=e.target.result;e&&(t=e.value[l],o.push(t),r.delete(t),s<n-o.length)&&e.continue()})},n.oncomplete=function(){e(o)},n.onabort=t}):Promise.resolve([])).then(function(e){return t.concat(e)});var a,s});var c,a,s}}},{}],3:[function(e,t,n){function o(e){return e.reduce(function(e,t){return e.concat(t)},[])}e("serviceworker-cache-polyfill");var r=e("./helpers"),i=e("./router"),c=e("./options");t.exports={fetchListener:function(e){var t=i.match(e.request);t?e.respondWith(t(e.request)):i.default&&"GET"===e.request.method&&0===e.request.url.indexOf("http")&&e.respondWith(i.default(e.request))},activateListener:function(e){r.debug("activate event fired");var t=c.cache.name+"$$$inactive$$$";e.waitUntil(r.renameCache(t,c.cache.name))},installListener:function(e){var t=c.cache.name+"$$$inactive$$$";r.debug("install event fired"),r.debug("creating cache ["+t+"]"),e.waitUntil(r.openCache({cache:{name:t}}).then(function(t){return Promise.all(c.preCacheItems).then(o).then(r.validatePrecacheInput).then(function(e){return r.debug("preCache list: "+(e.join(", ")||"(none)")),t.addAll(e)})}))}}},{"./helpers":1,"./options":4,"./router":6,"serviceworker-cache-polyfill":16}],4:[function(e,t,n){var o=self.registration?self.registration.scope:self.scope||new URL("./",self.location).href;t.exports={cache:{name:"$$$toolbox-cache$$$"+o+"$$$",maxAgeSeconds:null,maxEntries:null,queryOptions:null},debug:!1,networkTimeoutSeconds:null,preCacheItems:[],successResponses:/^0|([123]\d\d)|(40[14567])|410$/}},{}],5:[function(e,t,n){function o(e,t,n,o){t instanceof RegExp?this.fullUrlRegExp=t:(0!==t.indexOf("/")&&(t=r+t),this.keys=[],this.regexp=i(t,this.keys)),this.method=e,this.options=o,this.handler=n}var r=new URL("./",self.location).pathname,i=e("path-to-regexp");o.prototype.makeHandler=function(e){var n,o;return this.regexp&&(n=this.regexp.exec(e),o={},this.keys.forEach(function(e,t){o[e.name]=n[t+1]})),function(e){return this.handler(e,o,this.options)}.bind(this)},t.exports=o},{"path-to-regexp":15}],6:[function(e,t,n){function i(e,t){for(var n=e.entries(),o=n.next(),r=[];!o.done;)new RegExp(o.value[0]).test(t)&&r.push(o.value[1]),o=n.next();return r}function r(){this.routes=new Map,this.routes.set(RegExp,new Map),this.default=null}var c=e("./route"),a=e("./helpers");["get","post","put","delete","head","any"].forEach(function(o){r.prototype[o]=function(e,t,n){return this.add(o,e,t,n)}}),r.prototype.add=function(e,t,n,o){o=o||{},r=t instanceof RegExp?RegExp:(r=o.origin||self.location.origin)instanceof RegExp?r.source:r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),e=e.toLowerCase();var n=new c(e,t,n,o),o=(this.routes.has(r)||this.routes.set(r,new Map),this.routes.get(r)),r=(o.has(e)||o.set(e,new Map),o.get(e)),o=n.regexp||n.fullUrlRegExp;r.has(o.source)&&a.debug('"'+t+'" resolves to same regex as existing route.'),r.set(o.source,n)},r.prototype.matchMethod=function(e,t){var n=new URL(t),o=n.origin,n=n.pathname;return this._match(e,i(this.routes,o),n)||this._match(e,[this.routes.get(RegExp)],t)},r.prototype._match=function(e,t,n){if(0!==t.length)for(var o=0;o<t.length;o++){var r=t[o],r=r&&r.get(e.toLowerCase());if(r){r=i(r,n);if(0<r.length)return r[0].makeHandler(n)}}return null},r.prototype.match=function(e){return this.matchMethod(e.method,e.url)||this.matchMethod("any",e.url)},t.exports=new r},{"./helpers":1,"./route":5}],7:[function(e,t,n){var i=e("../options"),c=e("../helpers");t.exports=function(n,e,o){var r=(o=o||{}).cache||i.cache,t=r.queryOptions;return c.debug("Strategy: cache first ["+n.url+"]",o),c.openCache(o).then(function(e){return e.match(n,t).then(function(e){var t=Date.now();return c.isResponseFresh(e,r.maxAgeSeconds,t)?e:c.fetchAndCache(n,o)})})}},{"../helpers":1,"../options":4}],8:[function(e,t,n){var i=e("../options"),c=e("../helpers");t.exports=function(t,e,n){var o=(n=n||{}).cache||i.cache,r=o.queryOptions;return c.debug("Strategy: cache only ["+t.url+"]",n),c.openCache(n).then(function(e){return e.match(t,r).then(function(e){var t=Date.now();if(c.isResponseFresh(e,o.maxAgeSeconds,t))return e})})}},{"../helpers":1,"../options":4}],9:[function(e,t,n){var u=e("../helpers"),l=e("./cacheOnly");t.exports=function(c,a,s){return u.debug("Strategy: fastest ["+c.url+"]",s),new Promise(function(t,n){function e(e){e instanceof Response?t(e):i("No result returned")}var o=!1,r=[],i=function(e){r.push(e.toString()),o?n(new Error('Both cache and network failed: "'+r.join('", "')+'"')):o=!0};u.fetchAndCache(c.clone(),s).then(e,i),l(c,a,s).then(e,i)})}},{"../helpers":1,"./cacheOnly":8}],10:[function(e,t,n){t.exports={networkOnly:e("./networkOnly"),networkFirst:e("./networkFirst"),cacheOnly:e("./cacheOnly"),cacheFirst:e("./cacheFirst"),fastest:e("./fastest")}},{"./cacheFirst":7,"./cacheOnly":8,"./fastest":9,"./networkFirst":11,"./networkOnly":12}],11:[function(e,t,n){var o=e("../options"),f=e("../helpers");t.exports=function(i,e,c){var a=(c=c||{}).cache||o.cache,s=a.queryOptions,u=c.successResponses||o.successResponses,l=c.networkTimeoutSeconds||o.networkTimeoutSeconds;return f.debug("Strategy: network first ["+i.url+"]",c),f.openCache(c).then(function(e){var t,n,o=[],r=(l&&(r=new Promise(function(o){t=setTimeout(function(){e.match(i,s).then(function(e){var t=Date.now(),n=a.maxAgeSeconds;f.isResponseFresh(e,n,t)&&o(e)})},1e3*l)}),o.push(r)),f.fetchAndCache(i,c).then(function(e){if(t&&clearTimeout(t),u.test(e.status))return e;throw f.debug("Response was an HTTP error: "+e.statusText,c),n=e,new Error("Bad response")}).catch(function(t){return f.debug("Network or response error, fallback to cache ["+i.url+"]",c),e.match(i,s).then(function(e){if(e)return e;if(n)return n;throw t})}));return o.push(r),Promise.race(o)})}},{"../helpers":1,"../options":4}],12:[function(e,t,n){var o=e("../helpers");t.exports=function(e,t,n){return o.debug("Strategy: network only ["+e.url+"]",n),fetch(e)}},{"../helpers":1}],13:[function(e,t,n){var o=e("./options"),r=e("./router"),i=e("./helpers"),c=e("./strategies"),e=e("./listeners");i.debug("Service Worker Toolbox is loading"),self.addEventListener("install",e.installListener),self.addEventListener("activate",e.activateListener),self.addEventListener("fetch",e.fetchListener),t.exports={networkOnly:c.networkOnly,networkFirst:c.networkFirst,cacheOnly:c.cacheOnly,cacheFirst:c.cacheFirst,fastest:c.fastest,router:r,options:o,cache:i.cache,uncache:i.uncache,precache:i.precache}},{"./helpers":1,"./listeners":3,"./options":4,"./router":6,"./strategies":10}],14:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],15:[function(e,t,n){function p(e,t){for(var n=[],o=0,r=0,i="",c=t&&t.delimiter||"/";null!=(f=w.exec(e));){var a,s,u,l,f,p=f[0],h=f[1],d=f.index;i+=e.slice(r,d),r=d+p.length,h?i+=h[1]:(d=e[r],p=f[2],h=f[3],a=f[4],s=f[5],u=f[6],l=f[7],i&&(n.push(i),i=""),f=f[2]||c,n.push({name:h||o++,prefix:p||"",delimiter:f,optional:"?"===u||"*"===u,repeat:"+"===u||"*"===u,partial:null!=p&&null!=d&&d!==p,asterisk:!!l,pattern:(h=a||s)?h.replace(/([=!:$\/()])/g,"\\$1"):l?".*":"[^"+g(f)+"]+?"}))}return r<e.length&&(i+=e.substr(r)),i&&n.push(i),n}function h(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function o(l){for(var f=new Array(l.length),e=0;e<l.length;e++)"object"==typeof l[e]&&(f[e]=new RegExp("^(?:"+l[e].pattern+")$"));return function(e,t){for(var n="",o=e||{},r=(t||{}).pretty?h:encodeURIComponent,i=0;i<l.length;i++){var c=l[i];if("string"!=typeof c){var a,s=o[c.name];if(null==s){if(c.optional){c.partial&&(n+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(x(s)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(s)+"`");if(0===s.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var u=0;u<s.length;u++){if(a=r(s[u]),!f[i].test(a))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(a)+"`");n+=(0===u?c.prefix:c.delimiter)+a}}else{if(a=c.asterisk?encodeURI(s).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}):r(s),!f[i].test(a))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+a+'"');n+=c.prefix+a}}else n+=c}return n}}function g(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function d(e,t){return e.keys=t,e}function m(e){return e.sensitive?"":"i"}function v(e,t,n){x(t)||(n=t||n,t=[]);for(var o=(n=n||{}).strict,r=!1!==n.end,i="",c=0;c<e.length;c++){var a,s,u=e[c];"string"==typeof u?i+=g(u):(a=g(u.prefix),s="(?:"+u.pattern+")",t.push(u),u.repeat&&(s+="(?:"+a+s+")*"),i+=s=u.optional?u.partial?a+"("+s+")?":"(?:"+a+"("+s+"))?":a+"("+s+")")}var l=g(n.delimiter||"/"),f=i.slice(-l.length)===l;return o||(i=(f?i.slice(0,-l.length):i)+"(?:"+l+"(?=$))?"),i+=r?"$":o&&f?"":"(?="+l+"|$)",d(new RegExp("^"+i,m(n)),t)}function y(e,t,n){if(x(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp){var o=e,r=t,i=o.source.match(/\((?!\?)/g);if(i)for(var c=0;c<i.length;c++)r.push({name:c,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return d(o,r)}if(x(e)){for(var a=e,s=t,u=n,l=[],f=0;f<a.length;f++)l.push(y(a[f],s,u).source);return d(new RegExp("(?:"+l.join("|")+")",m(u)),s)}return o=t,v(p(e,t=n),o,t)}var x=e("isarray"),w=(t.exports=y,t.exports.parse=p,t.exports.compile=function(e,t){return o(p(e,t))},t.exports.tokensToFunction=o,t.exports.tokensToRegExp=v,new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g"))},{isarray:14}],16:[function(e,t,n){var o,r,i,c;i=Cache.prototype.addAll,(c=navigator.userAgent.match(/(Firefox|Chrome)\/(\d+\.)/))&&(o=c[1],r=parseInt(c[2])),i&&(!c||"Firefox"===o&&46<=r||"Chrome"===o&&50<=r)||(Cache.prototype.addAll=function(n){function o(e){this.name="NetworkError",this.code=19,this.message=e}var r=this;return o.prototype=Object.create(Error.prototype),Promise.resolve().then(function(){if(arguments.length<1)throw new TypeError;return n=n.map(function(e){return e instanceof Request?e:String(e)}),Promise.all(n.map(function(e){"string"==typeof e&&(e=new Request(e));var t=new URL(e.url).protocol;if("http:"!==t&&"https:"!==t)throw new o("Invalid scheme");return fetch(e.clone())}))}).then(function(e){if(e.some(function(e){return!e.ok}))throw new o("Incorrect response status");return Promise.all(e.map(function(e,t){return r.put(n[t],e)}))}).then(function(){})},Cache.prototype.add=function(e){return this.addAll([e])})},{}]},{},[13])(13)}),t.toolbox.options.debug=!1,t.toolbox.options.cache={name:"bdv2::",maxEntries:100,maxAgeSeconds:604800},t.toolbox.options.preCacheItems=["/","/?utm_source=web_app_manifest"],t.toolbox.router.get(/\.bikedekho\.com\/fonts\//,t.toolbox.cacheFirst),t.toolbox.router.get("/news/*",t.toolbox.networkFirst,{origin:/.bikedekho.com/}),t.toolbox.router.get("/road-test*",t.toolbox.networkFirst,{origin:/.bikedekho.com/}),t.toolbox.router.get("/latest-*",t.toolbox.networkFirst,{origin:/.bikedekho.com/}),t.toolbox.router.get("/best-*",t.toolbox.networkFirst,{origin:/.bikedekho.com/}),t.toolbox.router.get("/upcoming-*",t.toolbox.networkFirst,{origin:/.bikedekho.com/}),t.toolbox.router.get("/compare",t.toolbox.networkFirst,{origin:/.bikedekho.com/}),t.toolbox.router.get(/\.gaadicdn\.com\//,e,{cache:{name:"assets-bd-v2",maxEntries:100,maxAgeSeconds:604800}}),t.toolbox.router.get(/\.bikedekho\.com\/pwa\//,e,{cache:{name:"assets-bd-v2",maxEntries:100,maxAgeSeconds:86400}}),t.addEventListener("install",function(e){return e.waitUntil(t.skipWaiting())}),t.addEventListener("activate",function(e){return e.waitUntil(t.clients.claim())}),t.addEventListener("activate",e=>{let t=["v2"];e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(!t.includes(e))return caches.delete(e)}))))}),_connectoSW.log=function(e){_connectoSW.logging&&console&&console.log(e)},_connectoSW.getNotificationsActions=function(e,t){var n=[];return 1==t?n=[{action:9,title:e.actionButtonText1,icon:e.imageUrl1}]:2==t&&(n=[{action:9,title:e.actionButtonText1,icon:e.imageUrl1},{action:10,title:e.actionButtonText2,icon:e.imageUrl2}]),n},_connectoSW.getNotificationsOptions=function(e){var t={data:{}};return e&&e.type&&(t.data.connectoId=e.connectoId,t.data.campaignId=e.campaignId,t.data.type=e.type||null,t.body=e.message||null,t.icon=e.icon||null,t.badge=e.badge||null,t.image=e.bannerUrl||null,t.data.targetUrl=e.targetUrl||null,t.data.defaultAction=8,t.vibrate=e.vibrate||null,t.data.notificationId=e.notificationId||null,t.data.profileId=e.profileId||null,t.tag=e.tag||null,t.requireInteraction=e.require_interaction||!1,3!=e.type&&"3"!=e.type||(t.data.targetUrl1=e.targetUrl1||null,t.actions=_connectoSW.getNotificationsActions(e,1)),4!=e.type&&"4"!=e.type||(t.data.targetUrl1=e.targetUrl1||null,t.data.targetUrl2=e.targetUrl2||null,t.actions=_connectoSW.getNotificationsActions(e,2)),["image","icon","badge"].forEach(function(e){t[e]||delete t[e]}),t.actions)&&0<t.actions.length&&t.actions.forEach(function(e){e.icon||delete e.icon}),t},_connectoSW.getUrlForUserAction=function(e,t,n){var o=e.notificationId||"",e=e.profileId||"",r=_connectoSW.pushUrl+"/chromePush/track";return(r=(r=(r=(r=(r+="?version="+encodeURIComponent(_connectoSW.version))+("&writeKey="+encodeURIComponent(_connectoSW.writeKey)))+("&actionType="+encodeURIComponent(t)))+("&notificationId="+encodeURIComponent(o)))+("&profileId="+encodeURIComponent(e)))+("&domain="+encodeURIComponent(self.origin))},self.addEventListener("install",function(e){e.waitUntil(self.skipWaiting())}),self.addEventListener("activate",function(){_connectoSW.log("Activated Connecto ServiceWorker version:"+_connectoSW.version)}),_connectoSW.extractActionInformation=function(e,t){for(var n=0;n<e.actions.length;n++){var o=null,r=(e.actions[n].icon&&"null"!==e.actions[n].icon.split("/").pop()&&(o=e.actions[n].icon),null),i=(e.actions[n].title&&(r=e.actions[n].title),null);e.data["targetUrl"+(n+1)]&&(i=e.data["targetUrl"+(n+1)]),r&&(t["actionButtonText"+(n+1)]=r),i&&(t["actionButtonTargetUrl"+(n+1)]=i),o&&(t["actionButtonIcon"+(n+1)]=o)}return t},_connectoSW.setNotificationType=function(e,t){switch(e.actions.length){case 0:e.image&&"string"==typeof e.image&&e.image.split("/").pop()?t.NotificationType="Text with Banner":t.NotificationType="Plain Text";break;case 1:t.NotificationType="With 1 button";break;case 2:t.NotificationType="With 2 buttons";break;case 2<e.actions.length:t.NotificationType="More than 2 buttons"}return t},_connectoSW.extractSurfaceInformation=function(e,t){return e.title&&(t.Title=e.title),e.data.targetUrl&&(t.TargetUrl=e.data.targetUrl),e.icon&&"null"!==e.icon.split("/").pop()&&(t.icon=e.icon),e.image&&"null"!==e.image.split("/").pop()&&(t.image=e.image),e.body&&"null"!==e.body&&(t.Body=e.body),t},_connectoSW.getUTMparams=function(e,t){var n;e.TargetUrl&&(e=e.TargetUrl,(n={utm_source:_connectoSW.getQueryStringValue("utm_source",e),utm_medium:_connectoSW.getQueryStringValue("utm_medium",e),utm_campaign:_connectoSW.getQueryStringValue("utm_campaign",e),utm_content:_connectoSW.getQueryStringValue("utm_content",e),utm_term:_connectoSW.getQueryStringValue("utm_term",e)})&&0<Object.keys(n).length&&Object.keys(n).forEach(function(e){n[e]&&null!=n[e]||delete n[e]}),t.utm_param=n=={}?void 0:n)},_connectoSW.getQueryStringValue=function(e,t){return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))},_connectoSW.insightCassandra=function(e,t,n,o){if(e){var r={},i={};switch(t&&(i.connectoId=t),n&&(r.campaignId=n),e.type){case"notificationclose":i.UserAction="Notification Closed";break;case"notificationclick":i.UserAction="Notification Clicked";break;case"push":i.UserAction="Notification Delivered"}t=e.notification;t&&((t=e.notification).actions||(t.actions=[]),r=_connectoSW.setNotificationType(t,r),0<t.actions.length&&(r=_connectoSW.extractActionInformation(t,r)),r=_connectoSW.extractSurfaceInformation(t,r),_connectoSW.getUTMparams(r,i),r.eventTime=o,_connectoSW.createTrackRequest(r,i))}},_connectoSW.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},_connectoSW.createTrackRequest=function(e,t){var n;_connectoSW.apiUrl&&_connectoSW.pushUrl&&self&&self.origin&&(e.utm_param=JSON.stringify(t.utm_param),e.UserAction=JSON.stringify(t.UserAction),n="Notification Clicked"==t.UserAction?t.utm_param:void 0,t={messageId:_connectoSW.guid(),type:"track",event:t.UserAction,userId:t.connectoId,timestamp:new Date,writeKey:_connectoSW.writeKey,channel:"web",context:{url:self.origin,utm_param:n,library:{name:"connecto-backend",version:"1.0"}},properties:e},n=_connectoSW.apiUrl+"/generatedEvents",fetch(n,{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}).then(function(e){}).catch(function(e){}))},_connectoSW.createIdentifyRequest=function(e){var t;_connectoSW.apiUrl&&_connectoSW.pushUrl&&self&&self.origin&&(e={type:"identify",userId:"",writeKey:_connectoSW.writeKey,timestamp:new Date,traits:{$chromePushDetails:JSON.stringify(e)},messageId:_connectoSW.guid(),channel:"web",context:{url:self.origin,library:{name:"connecto-backend",version:"1.0"}}},t=_connectoSW.apiUrl+"/identify",fetch(t,{method:"post",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}).then(function(e){}).catch(function(e){}))},self.addEventListener("notificationclose",function(e){_connectoSW.log("notificationclose listener",e);var t=e.notification.data.campaignId,n=e.notification.data.connectoId;_connectoSW.insightCassandra(e,n,t,Date.now()),fetch(_connectoSW.getUrlForUserAction(e.notification.data,20,!1))}),self.addEventListener("notificationclick",function(e){_connectoSW.log("notificationclick listener",e);var t,n,o,r=8;e.notification&&(t=e.notification.data.campaignId,n=e.notification.data.connectoId,e.notification.close(),_connectoSW.log("Closed Notification"),e.notification.data)&&(_connectoSW.log("Redirecting to Target url"),e.action&&9==e.action?(o=e.notification.data.targetUrl1||null,r=e.action,o&&clients&&clients.openWindow(o)):e.action&&10==e.action?(o=e.notification.data.targetUrl2||null,r=e.action,o&&clients&&clients.openWindow(o)):(o=e.notification.data.targetUrl||null)&&clients&&clients.openWindow(o),fetch(_connectoSW.getUrlForUserAction(e.notification.data,r,!1)),_connectoSW.insightCassandra(e,n,t,Date.now()))}),self.addEventListener("push",function(e){var t,n;e&&e.data&&(t=e.data.json())&&t.tag&&0<=t.tag.indexOf("connecto")&&t.title&&(fetch(_connectoSW.getUrlForUserAction(t,6,!0)),_connectoSW.log("Push Event Happened",e),n=_connectoSW.getNotificationsOptions(t),e.notification=n,e.waitUntil(self.registration.showNotification(t.title,n)))}),self.addEventListener("pushsubscriptionchange",function(e){var t=_connectoSW.VAPID;t&&(t=_connectoSW.convertArrayAtob(t),e.waitUntil(self.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t}).then(function(e){e&&_connectoSW.createIdentifyRequest(e)})))})})(self);