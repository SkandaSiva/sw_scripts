!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="240c073a-8533-46e7-9ade-eac69426091c",t._sentryDebugIdIdentifier="sentry-dbid-240c073a-8533-46e7-9ade-eac69426091c")}catch(t){}}(),function(){"use strict";var t=function(){return t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},t.apply(this,arguments)};function e(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function s(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))}function n(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;function r(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Object.create;"function"==typeof SuppressedError&&SuppressedError;var i,o,a;function s(t){return new URL(t,"https://www.twitch.tv")}function c(t){var e,n=s(a.HomePage).href;if(!t)return n;switch(t.type){case o.ChannelPage:return t.key?s(t.key).href:n;case o.NotificationSettingsPage:return s(a.NotificationSettingsPage).href;case o.BroadcasterDashboard:return s(a.BroadcasterDashboard).href;case o.BrowserGame:return t.key?s("".concat(a.BrowserGame,"/").concat(t.key)).href:s(a.BrowserGame).href;case o.StreamStats:return(e=a.StreamStats,new URL(e,"https://dashboard.twitch.tv")).href;default:return n}}!function(t){t.NewSession="new-session",t.ClearSession="clear-session"}(i||(i={})),function(t){t.HomePage="Homepage",t.ChannelPage="ChannelPage",t.NotificationSettingsPage="NotificationSettingsPage",t.BroadcasterDashboard="BroadcasterDashboard",t.WebOnly="WebOnly",t.BrowserGame="BrowseGame",t.StreamStats="StreamStats"}(o||(o={})),function(t){t.HomePage="",t.ChannelPage="",t.NotificationSettingsPage="/settings/notifications",t.BroadcasterDashboard="/dashboard/live",t.BrowserGame="/directory/game",t.StreamStats="/stream-summary"}(a||(a={}));var u,l,f,d=function(){function t(t,e,n){this.databaseName=t,this.databaseVersion=e,this.objectStoreName=n}return t.prototype.get=function(t){return e(this,void 0,Promise,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,this.withStore("readonly",(function(e){return e.get(t)}))];case 1:return[2,e.sent()]}}))}))},t.prototype.set=function(t,r){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,this.withStore("readwrite",(function(e){return e.put(r,t)}))];case 1:return e.sent(),[2]}}))}))},t.prototype.clear=function(){return e(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.withStore("readwrite",(function(t){return t.clear()}))];case 1:return t.sent(),[2]}}))}))},t.prototype.withStore=function(t,r){return e(this,void 0,Promise,(function(){var e,i=this;return n(this,(function(n){switch(n.label){case 0:return[4,this.getDB()];case 1:return e=n.sent(),[2,new Promise((function(n,o){var a=e.transaction(i.objectStoreName,t),s=a.objectStore(i.objectStoreName),c=r(s);a.oncomplete=function(){n(c.result)},a.onerror=function(){o(this.error)}}))]}}))}))},t.prototype.getDB=function(){return e(this,void 0,Promise,(function(){var t=this;return n(this,(function(e){return this.dbPromise||(this.dbPromise=new Promise((function(e,n){var r=indexedDB.open(t.databaseName,t.databaseVersion),i=t.objectStoreName;r.onupgradeneeded=function(){this.result.createObjectStore(i)},r.onsuccess=function(){var t=this.result;e(t)},r.onerror=function(){n(this.error)}}))),[2,this.dbPromise]}))}))},t}();function h(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];console.error.apply(console,r(["browser-push-notifications-worker",e,t],n,!1))}function b(t){y("notification_interaction",{notification_id:t.notificationID,action:t.action})}!function(t){t.Web="web",t.Desktop="desktop",t.MobileWeb="mobile_web",t.Android="android",t.iOS="ios"}(u||(u={})),function(t){t.Click="click",t.DoubleClick="double_click",t.RightClick="right_click",t.OpenContextMenu="open_context_menu",t.DropdownSelect="dropdown_select"}(l||(l={})),function(t){t.PrimaryCta="primary_cta",t.Dismiss="dismiss"}(f||(f={}));var p="https://spade.twitch.tv/",w=3;function y(r,i){return e(this,void 0,void 0,(function(){var e,o;return n(this,(function(n){switch(n.label){case 0:e=t({browser:navigator.userAgent,platform:u.Web,time:(new Date).getTime()/1e3,ui_context:"browser"},i),o=new Blob([(a=[{event:r,properties:e}],s=encodeURIComponent(JSON.stringify(a)).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x".concat(e)))})),c=btoa(s),"data=".concat(encodeURIComponent(c)))],{type:"application/x-www-form-urlencoded; charset=UTF-8"}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,v(o)];case 2:return n.sent(),[3,4];case 3:return h(n.sent(),"sending event failed"),[3,4];case 4:return[2]}var a,s,c}))}))}function v(t){return e(this,void 0,void 0,(function(){var e,r;return n(this,(function(n){switch(n.label){case 0:e=1,n.label=1;case 1:if(!(e<=w))return[3,6];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,fetch(p,{method:"POST",body:t})];case 3:return n.sent(),[2];case 4:if(r=n.sent(),e===w)throw r;return[3,5];case 5:return++e,[3,1];case 6:return[2]}}))}))}var m="current_user_id",g=function(){function t(t){var r=this;this.onPush=function(t){if(t.data){var i=t.data.json();t.waitUntil(e(r,void 0,void 0,(function(){var t,e,r,o,a,s,u;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,this.db.get(m)];case 1:return t=n.sent(),i.user_id!==t?[2]:[4,self.clients.matchAll({type:"window"})];case 2:for(e=n.sent(),r=new URL(i.redirect_url||c(i.mobile_destination)),o=0,a=e;o<a.length;o++)if(s=a[o],new URL(s.url).host===r.host&&"visible"===s.visibilityState)return[2];return u={notificationID:i.notification_id,redirectUrl:i.redirect_url||c(i.mobile_destination)},i.title||(i.title=i.body,i.body=""),[4,self.registration.showNotification(i.title,{icon:i.icon,body:i.body,data:u})];case 3:return n.sent(),y("notification_impression",{notification_id:u.notificationID}),[3,5];case 4:return h(n.sent(),"showing notification failed"),[3,5];case 5:return[2]}}))})))}},this.onNotificationClick=function(t){t.notification.close();var i=t.notification.data;t.waitUntil(e(r,void 0,void 0,(function(){var t,e,r,o,a;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,8,,9]),[4,self.clients.matchAll({type:"window"})];case 1:t=n.sent(),e=new URL(i.redirectUrl),r=0,o=t,n.label=2;case 2:return r<o.length?(a=o[r],new URL(a.url).host===e.host&&"focus"in a?[4,a.focus()]:[3,5]):[3,6];case 3:return[4,n.sent().navigate(i.redirectUrl)];case 4:return n.sent(),[2];case 5:return r++,[3,2];case 6:return[4,self.clients.openWindow(i.redirectUrl)];case 7:return n.sent(),[3,9];case 8:return h(n.sent(),"notification click failed"),[3,9];case 9:return[2]}}))}))),b({notificationID:i.notificationID,action:f.PrimaryCta})},this.onNotificationClose=function(t){t.notification.close(),b({notificationID:t.notification.data.notificationID,action:f.Dismiss})},this.onMessage=function(t){var e=JSON.parse(t.data);switch(e.type){case i.NewSession:t.waitUntil(r.storeUserId(e.userId));break;case i.ClearSession:t.waitUntil(r.clearDatabase());break;default:h(new Error("unhandled host message"),"unknown host message type",e)}},this.db=t}return t.prototype.bind=function(){self.addEventListener("push",this.onPush),self.addEventListener("notificationclick",this.onNotificationClick),self.addEventListener("notificationclose",this.onNotificationClose),self.addEventListener("message",this.onMessage)},t.prototype.clearDatabase=function(){return e(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.db.clear()];case 1:return t.sent(),[3,3];case 2:return h(t.sent(),"failed to clear database"),[3,3];case 3:return[2]}}))}))},t.prototype.storeUserId=function(t){return e(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.db.set(m,t)];case 1:return e.sent(),[3,3];case 2:return h(e.sent(),"failed to store user id"),[3,3];case 3:return[2]}}))}))},t}();var S;[];self.addEventListener("install",(function(t){t.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(function(t){t.waitUntil(self.clients.claim())})),S=new d("swnotifications",1,"swnotifications"),new g(S).bind()}();