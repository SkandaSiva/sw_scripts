"use strict";(()=>{importScripts("https://assets.solvhealth.com/mapp-dev/2024-11-04-47b4fc5/workbox/workbox-sw.js");workbox.setConfig({debug:!1,modulePathPrefix:"https://assets.solvhealth.com/mapp-dev/2024-11-04-47b4fc5/workbox/"});self.importScripts("https://assets.solvhealth.com/mapp-dev/2024-11-04-47b4fc5/precache_manifest.js","./sw-analytics-helper.js");var f=3;workbox.skipWaiting();var h=(t,s)=>self.registration.pushManager.getSubscription().then(e=>sendAnalyticsEvent(e.endpoint,t,s)).catch(e=>console.warn("Unable to get subscription data",e));self.addEventListener("activate",()=>{self.clients.matchAll().then(t=>{t.forEach(s=>{s.postMessage({type:"versionCheck",version:f})})})});self.addEventListener("push",t=>{if(t.data){let s=t.data.text(),e=Date.now(),o={},i={};try{o=JSON.parse(s)}catch(c){h("Web Push - Error parsing notification data",{swVersion:f,dateOfArrival:e,textData:s})}typeof o.body=="string"?i=o.body:typeof o.body=="undefined"&&typeof s=="string"?i=s:i="You have a new notification";let{title:a,url:r,wpsId:p}=o,n={title:a,body:i,icon:"images/icons/app/logo_192.png",vibrate:[100,50,100],data:{dateOfArrival:e,wpsId:p,url:r,title:a}},l=self.clients.matchAll().then(c=>{c.forEach(u=>{u.postMessage({type:"push",options:n})})}),d=h("Web Push - Received",{swVersion:f,wpsId:p,url:r,title:a,dateOfArrival:e});t.waitUntil(Promise.all([self.registration.showNotification(a,n),l,d]))}});addEventListener("notificationclick",t=>{t.notification.close();let s=Date.now(),e=t.notification.data||{},{url:o,wpsId:i,title:a}=e,r=self.clients.matchAll().then(n=>{let l={type:"click",data:e},d=e.url||"/";if(n.length>0)if(n[0].url==d&&"focus"in client)n[0].focus(),n.forEach(c=>{c.postMessage(l)});else return n[0].openWindow(d).then(c=>c.postMessage(l));else return self.clients.openWindow(d).then(c=>{c.postMessage(l)})}),p=h("Web Push - Clicked",{swVersion:f,wpsId:i,url:o,title:a,dateOfArrival:s});t.waitUntil(Promise.all([r,p]))});addEventListener("notificationclose",t=>{let s=Date.now(),e=t.notification.data||{},{url:o,wpsId:i,title:a}=e,r=h("Web Push - Closed",{swVersion:f,wpsId:i,url:o,title:a,dateOfArrival:s});t.waitUntil(r)});})();
