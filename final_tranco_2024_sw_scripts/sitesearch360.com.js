"use strict";var CACHE_NAME="sitesearch360-html-cache",URLS_TO_CACHE_MAP={en:["/","/features/","/pricing/","/ecommerce/"],de:["/de/","/de/funktionen/","/de/ecommerce/","/de/preis/"],fr:["/fr/","/fr/tarifs/"]},FLAT_URLS_TO_CACHE=Object.keys(URLS_TO_CACHE_MAP).reduce(function(t,e){return URLS_TO_CACHE_MAP[e].forEach(function(e){return t.push(e)}),t},[]),idb=indexedDB||mozIndexedDB||webkitIndexedDB||msIndexedDB,shouldCache=function(){return!0!==((navigator||{}).connection||{}).saveData},invalidateCache=function(){return caches.delete(CACHE_NAME).then(function(){caches.open(CACHE_NAME).then(function(e){var t="en";if(-1!==self.location.search.indexOf("lang=fr")?t="fr":-1!==self.location.search.indexOf("lang=de")&&(t="de"),void 0!==idb){var n=idb.open("SS360Cache",3);n.onupgradeneeded=function(e){var t=e.target.result,n=t.createObjectStore("cache",{keyPath:"key"});n.createIndex("key","key",{unique:!0}),n.transaction.oncomplete=function(){t.transaction("cache","readwrite").objectStore("cache").put({key:"cacheTimestamp",value:Date.now()})}},n.onsuccess=function(e){var t=e.target.result.transaction("cache","readwrite").objectStore("cache").put({key:"cacheTimestamp",value:Date.now()});t.onerror=function(){console.error(t.error.name)}}}if(shouldCache()){var r=URLS_TO_CACHE_MAP[t]||URLS_TO_CACHE_MAP.en;return e.addAll(r)}return e.addAll([])})})};self.addEventListener("install",function(e){e.waitUntil(invalidateCache())});var lastCheckTs=void 0;self.addEventListener("fetch",function(n){if(n.request.url.startsWith(self.location.origin)){for(var e=!1,t=0;t<FLAT_URLS_TO_CACHE.length;t++)if(n.request.url==="".concat(self.location.origin).concat(FLAT_URLS_TO_CACHE[t])){e=!0;break}if(!e&&("/"!==n.request.url[n.request.url.length-1]||"GET"!==n.request.method))return;n.respondWith(caches.match(n.request).then(function(e){return e||fetch(n.request).then(function(e){if(!e||200!==e.status||"basic"!==e.type)return e;var t=e.clone();return caches.open(CACHE_NAME).then(function(e){e.put(n.request,t)}),e})}))}void 0!==idb&&(void 0===lastCheckTs||3e4<Date.now()-lastCheckTs)&&(lastCheckTs=Date.now(),idb.open("SS360Cache").onsuccess=function(e){e.target.result.transaction("cache","readwrite").objectStore("cache").getAll().onsuccess=function(e){var t;try{t=(e.target.result.filter(function(e){return"cacheTimestamp"===e.key})[0]||{}).value}catch(e){}var n=void 0===t?void 0:Date.now()-t;(void 0===n||432e5<n)&&invalidateCache()}})});