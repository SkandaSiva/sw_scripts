const versionSW=2;var testMSG=function(e){try{const t=e.json();if(t.title)return true}catch(e){return false}};var trk_o_npb=function(o){if(o.icon&&o.icon!=""){try{let e=self.atob(o.icon.substring(39)),t=JSON.parse(e),i=t.u_red;delete t.u_red;let n=self.btoa(JSON.stringify(t));fetch("https://secure-api.notifadz.com/op?name="+n,{headers:new Headers,mode:"no-cors",redirect:"follow",cache:"no-cache"});return i}catch(e){console.log("error",e);return""}}else return""};function updateSubInfos(){self.registration.pushManager.getSubscription().then(function(e){})}var showNotification=function(r){return new Promise(function(t,e){let i="Notification";var n="";if(r){if(r.title){i=r.title}}self.registration.showNotification(i,r).then(()=>self.registration.getNotifications()).then(e=>{setTimeout(()=>e.forEach(e=>e.close()),36e5)});if(self.fetch){if(r.data.trkurl)n=r.data.trkurl;else n="https://secure-api.notifadz.com/p";var o=new Headers;var a=r.advertiserId||"";let e="";if(r.did&&r.did!=""&&r.did!=null){e="&did="+r.did}fetch(n+"?id_e="+r.e_id+"&id_c="+r.campaignId+"&id_a="+a+e,{method:"GET",credentials:"omit",headers:o,mode:"cors"}).then(function(){t(true)})}if(r.forceupdate&&r.forceupdate==1)self.registration.update()})};self.addEventListener("install",function(e){self.skipWaiting();console.log("The service working is beeing installed")});self.addEventListener("activate",()=>{self.clients.claim()});self.addEventListener("push",e=>{function t(t){var i="";if(t.data){var n=t.data.json();if(n.dyn&&n.dyn=="1"){LoadFunc(t);return true}else{var e=new Date;e.setDate(e.getDate()-7);if(testMSG(t.data)){let e="Notification";if(n){if(n.title){e=n.title}}n.icon=trk_o_npb(n);t.waitUntil(self.registration.showNotification(e,n).then(()=>{if(n.externalViewability&&n.externalViewability!=""){let e=Date.now(),t=n.externalViewability;fetch(t,{method:"GET",credentials:"omit",headers:o,mode:"no-cors"})}self.registration.getNotifications()}).then(e=>{setTimeout(()=>e.forEach(e=>e.close()),36e5)}));if(self.fetch){if(n.data.trkurl)i=n.data.trkurl;else i="https://secure-api.notifadz.com/p";var o=new Headers;var a=n.advertiserId||"";let e="";if(n.did&&n.did!=""&&n.did!=null){e="&did="+n.did}fetch(i+"?id_e="+n.e_id+"&id_c="+n.campaignId+"&id_a="+a+e,{method:"GET",credentials:"omit",headers:o,mode:"cors"})}if(n.forceupdate&&n.forceupdate==1)self.registration.update()}}return true}else{return true}}e.waitUntil(t(e))});var LoadFunc=function(pushEvent){return new Promise(function(resolve,reject){if(pushEvent&&pushEvent.data){var notification=pushEvent.data.json();if(notification.dyn&&notification.dyn=="1"&&notification.dyn_src){var myHeaders=new Headers({"Content-Type":"text/plain"}),url=notification.dyn_src;fetch(url,{method:"GET",credentials:"omit",headers:myHeaders,mode:"cors",cache:"no-cache"}).then(function(response){response.text().then(function(txt){try{eval(txt)}catch(error){console.log("can't terminate promise")}resolve()})}).catch(e=>{resolve()})}else{resolve()}}})};var LoadFuncDebug=function(notification){return new Promise(function(resolve,reject){var url="";if(notification.dyn&&(notification.dyn=="1"||notification.dyn=="2")&&notification.dyn_src){var myHeaders=new Headers({"Content-Type":"text/plain"}),url=notification.dyn_src;fetch(url,{method:"GET",credentials:"omit",headers:myHeaders,mode:"cors",cache:"no-cache"}).then(function(response){response.text().then(function(txt){try{eval(txt)}catch(error){console.log("can't terminate promise")}})})}else if(notification.dyn&&notification.dyn=="0"){let title="Notification";if(notification){if(notification.title){title=notification.title}}notification.icon=trk_o_npb(notification);self.registration.showNotification(title,notification).then(()=>self.registration.getNotifications()).then(e=>{setTimeout(()=>e.forEach(e=>e.close()),36e5)})}})};self.addEventListener("notificationclick",function(t){var e=t.notification.data,i=0;if(Array.isArray(e.actions)){e.actions.forEach(function(e){if(t.action&&t.action===e.action){i=1;clients.openWindow(e.url)}});if(i==0)clients.openWindow(e.url)}else{clients.openWindow(e.url)}t.notification.close()},false);self.addEventListener("updatefound",function(){var e=registration.installing;console.log("A new service worker is being installed :",e)});self.addEventListener("message",e=>{if(e.data&&e.data.type==="fake"){if(e.data.msg.pp&&e.data.msg.pp=="adr")self.nadzpp="adr";LoadFuncDebug(e.data.msg)}});self.addEventListener("pushsubscriptionchange",function(e){e.waitUntil(()=>{return(async e=>{let t={oldSub:e.oldSubscription===undefined?{}:JSON.stringify(e.oldSubscription.options),newSub:e.newSubscription===undefined?{}:JSON.stringify(e.newSubscription.options)},i={c:JSON.stringify(t)},n="https://secure-api.notifadz.com/r";fetch(n,{method:"POST",headers:new Headers({accept:"*/*"}),mode:"no-cors",site:"cross-site",redirect:"follow",cache:"no-cache",body:JSON.stringify(i)})})(e)})});