self.addEventListener("push",(function(t){var i=t?.data?.json(),n=new Headers;n.append("Authorization",i?.token),n.append("Content-Type","application/json");var e={method:"POST",headers:n,body:JSON.stringify({tracking_type:"delivered"})};fetch(i?.notification_service_url+"/notification_tracking",e).then((t=>t.text())).then((t=>{})).catch((t=>{}));var a=i?.title,o=Array.isArray(i.actions)?i.actions:[];o=o.map((function(t){return{action:t?.redirect_url??"",title:t?.title??""}}));var c={body:i?.description,icon:i?.logo_url,image:i?.image_url,actions:o,data:{token:i?.token,endpoint:i?.notification_service_url,url:i?.redirect_url,id:i?.event_id||""}};t.waitUntil(self.registration.showNotification(a,c))})),self.addEventListener("notificationclick",(function(t){var i=t?.notification?.data?.url,n=t?.notification?.data?.token,e=t?.notification?.data?.endpoint,a=""===t?.action||null==t?.action?i:t?.action,o="clicked";for(let i=0;i<t?.notification?.actions?.length;i++)t?.notification?.actions[i]?.action===a&&(1===i&&(o="secondary_button_clicked"),0===i&&(o="primary_button_clicked"));var c=new Headers;c.append("Authorization",n),c.append("Content-Type","application/json");var r=JSON.stringify({tracking_type:o});fetch(e+"/notification_tracking",{method:"POST",headers:c,body:r}).then((t=>t.text())).then((t=>{})).catch((t=>{})),t.notification.close(),t.waitUntil(self.clients.matchAll({type:"all"}).then((function(t){for(var i=0;i<t.length;i++){var n=t[i];if(n?.url===a&&"focus"in n||"focus"in n)return n.focus()}if(self.clients.openWindow)return self.clients.openWindow(a)})))})),self.addEventListener("install",(function(t){t.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(function(t){t.waitUntil(self.clients.claim())}));