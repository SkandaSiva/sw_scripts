importScripts('https://storage.googleapis.com/workbox-cdn/releases/6.2.0/workbox-sw.js');workbox.loadModule('workbox-strategies');workbox.loadModule('workbox-precaching');workbox.loadModule('workbox-routing');workbox.loadModule('workbox-expiration');workbox.loadModule('workbox-cacheable-response');if(workbox){console.log("Workbox loaded!");}else{console.log("Can't load Workbox");}
workbox.core.setCacheNameDetails({prefix:"foronum-app",suffix:"v1",precache:"precache-cache",runtime:"runtime-cache",});workbox.routing.registerRoute(/\.(?:js|css)$/,new workbox.strategies.StaleWhileRevalidate({cacheName:'static-resources',}));workbox.routing.registerRoute(({request})=>request.mode==='navigate',new workbox.strategies.NetworkFirst({cacheName:'html-cache',}));workbox.precaching.precacheAndRoute([{url:'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js',revision:null},{url:'https://www.foronum.com/js/menu/hc-offcanvas-nav.min.js',revision:null},{url:'https://www.foronum.com/img/css_flags.png',revision:null},{url:'https://www.foronum.com/img/logo.webp',revision:null},{url:'https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap',revision:null},]);workbox.routing.registerRoute(({request})=>request.destination==='image',new workbox.strategies.CacheFirst({cacheName:'images-cache',plugins:[new workbox.expiration.ExpirationPlugin({maxAgeSeconds:30*24*60*60,maxEntries:60,purgeOnQuotaError:true,}),],}));workbox.routing.registerRoute(({request})=>request.destination==='style',new workbox.strategies.CacheFirst({cacheName:'css-cache',plugins:[new workbox.expiration.ExpirationPlugin({maxAgeSeconds:7*24*60*60,maxEntries:10,purgeOnQuotaError:true,}),],}));workbox.routing.registerRoute(new RegExp('https://fonts.(?:googleapis|gstatic).com/(.*)'),new workbox.strategies.CacheFirst({cacheName:'google-fonts',plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:30,}),new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200],}),],}),);workbox.routing.registerRoute(new RegExp('https://cdnjs.cloudflare.com/ajax/libs/(.*)'),new workbox.strategies.CacheFirst({cacheName:'cdn-cloudflare',plugins:[new workbox.expiration.ExpirationPlugin({maxEntries:30,}),new workbox.cacheableResponse.CacheableResponsePlugin({statuses:[0,200],}),],}),);self.addEventListener('activate',(event)=>{const currentCaches=['static-resources','images-cache','html-cache','google-fonts','cdn-cloudflare'];event.waitUntil(caches.keys().then((cacheNames)=>{return cacheNames.filter((cacheName)=>!currentCaches.includes(cacheName));}).then((cachesToDelete)=>{return Promise.all(cachesToDelete.map((cacheToDelete)=>{return caches.delete(cacheToDelete);}));}));});