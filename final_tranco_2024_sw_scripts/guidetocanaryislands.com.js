const pushUrl="https://www.guidetocanaryislands.com/push-subscription-action/";const applicationServerKey="BMT5sOoKbSQURs1qBIxGil52nWwrFzoRI6aMPBHDE0reL-najWbG5-p5MoQ6bT-MHBTUD_vm9IoTcuzbiWr2BCw";self.addEventListener('install',function(event){self.skipWaiting()});self.addEventListener('activate',function(event){});self.addEventListener('push',function(event){if(!(self.Notification&&self.Notification.permission==='granted')){return}
let notificationData={};try{if(IsJsonString(event.data.text())){notificationData=JSON.parse(event.data.text());const title=notificationData.title;const options={body:notificationData.body,icon:notificationData.icon,image:notificationData.image,badge:notificationData.badge,tag:notificationData.tag,requireInteraction:notificationData.btn};event.waitUntil(self.registration.showNotification(title,options))}else{event.waitUntil(fetch(event.data.text()).then(function(response){if(response.status!==200){throw new Error()}
return response.json().then(function(notificationData){if(notificationData.error||!notificationData.title){throw new Error()}
return self.registration.showNotification(notificationData.title,{body:notificationData.body,icon:notificationData.icon,image:notificationData.image,badge:notificationData.badge,tag:notificationData.tag,requireInteraction:notificationData.btn})})}).catch(function(err){}))}}catch(e){}});function IsJsonString(str){try{JSON.parse(str)}catch(e){return!1}
return!0}
function openWindow(event){const promiseChain=clients.openWindow(event.notification.tag);event.waitUntil(promiseChain)}
self.addEventListener('notificationclick',function(event){event.notification.close();if(event.notification.tag.length){openWindow(event)}});const notificationCloseAnalytics=()=>{return Promise.resolve()};self.addEventListener('notificationclose',function(event){const dismissedNotification=event.notification;const promiseChain=notificationCloseAnalytics();event.waitUntil(promiseChain)});self.addEventListener('fetch',function(event){var request=event.request;if(request.url.match('^.*(\/user\/|\/amp\/\|\/ajax\/\|\.mp4|\.webm|\.jpg|\.png|\.gif|\.js|\.css|\.pdf|\.zip|\.xls|\.doc|\.docx|\.xlsx|\.ttf|\.woff|\.svg|\.eot|\.webp|ads\.txt|\.php).*$')){return!1}
if(request.method==='GET'){event.respondWith(fetch(request).catch(unableToResolve))}});function unableToResolve(){return new Response("<h1>Oops, you're offline...</h1><p>It'll have to wait until you're back online.<br/>Soon let's hope!</p>",{status:503,statusText:'Service Unavailable',headers:new Headers({'Content-Type':'text/html'})})}