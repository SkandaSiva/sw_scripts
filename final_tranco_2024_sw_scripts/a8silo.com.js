!function(){"use strict";var e,t,n={O9yl:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var a;t.Z={objPlus:function(e,t){var n={};for(var a in e)n[a]=e[a];for(var a in t)n[a]=t[a];return n},objFill:function(e,t){var n=Object.keys(e);for(var a in t)n.indexOf(a)>=0&&(e[a]=t[a]);return e},objFillDefaults:function(e,t){for(var n in t)void 0!==e[n]&&null!==e[n]||(e[n]=t[n]);return e},objRemoveDefaults:function(e){var t={};for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t},isNil:function(e){return null==e},isNonNil:function(e){return!this.isNil(e)},validVal:function(e){return this.isNil(e)||e.trim().length<=0?null:e},async:function(e){return setTimeout(e,0)},toTitleCase:function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},toSafeURLString:function(e){return e.replace(/[^a-z0-9-_~]*/gi,"")},toSafeHTMLString:function(e){return"undefined"==typeof DOMParser?e||"":(new DOMParser).parseFromString(e||"","text/html").body.textContent},sanitizeUnsafeHTMLString:function(e,t,n,a){t=t||[],n=n||[],a=a||[];var i=(new DOMParser).parseFromString(e||"","text/html").body,o=t.length<=0?null:t.join(", "),s=n.length<=0?null:n.join(", ");return o&&i.querySelectorAll(o).forEach((function(e){e.parentNode.removeChild(e)})),s&&i.querySelectorAll(s).forEach((function(e){e.parentNode.replaceChild(e.ownerDocument.createTextNode(e.textContent),e)})),a.forEach((function(e){i.querySelectorAll("*["+e+"]").forEach((function(t){t.removeAttribute(e)}))})),i.innerHTML},parseURLString:function(e){var t=/^(\w+):\/\/([^\/\?#]+)(\/[^\?#]*)?(\?[^#]*)?(#.*)?$/i.exec(e);return t&&{schema:t[1],hostname:t[2],root:t[1]+"://"+t[2],path:t[3],search:t[4],anchor:t[5]}},parseQueryString:function(e,t,n){var a={};if(this.isNil(e)){if(!document||!document.location)return{};e=document.location.search}t=t||"&",n=n||"=";for(var i,o=0,s=(e=e.replace(/^\?/,"")).split(t),r=s.length;o<r;o++)(i=s[o].split(n)).length>1&&(a[this.unescapeQueryString(i.shift())]=this.unescapeQueryString(i.join(n)));return a},unescapeQueryString:function(e){return decodeURIComponent(e.replace(/\+/g," "))},getLauncherHost:function(e){var t=ENV.launcherHost,n=this.parseQueryString(e),a=n&&n.l;if(t&&t.indexOf("!")>=0)try{var i=t.split("!")[2],o=t.split("!")[1].split(",");t=i.replace(new RegExp(o[0]),o[1])}catch(e){console.warn("could not parse launcher host regex")}if(a){var s=a.replace(/[\#].*/,""),r=function(e){return e.split(/\./).slice(e.search(/\.co\.[a-z][a-z]$/)>0?-3:-2).join(".")},l=r(this.parseURLString((ENV.webSocketProto||"wss://")+s).hostname);if(r(this.parseURLString((ENV.webSocketProto||"wss://")+t).hostname)===l)return s}return t},getLauncherPort:function(e){var t=ENV.launcherPort,n=this.parseQueryString(e),a=n&&n.lp;return a?a.replace(/[\#].*/,""):t},getAppHost:function(e){var t=ENV.launcherHost,n=ENV.appHost,a=this.parseQueryString(e),i=a&&a.s;if(n&&n.indexOf("!")>=0)try{var o=n.split("!")[2],s=n.split("!")[1].split(",");n=o.replace(new RegExp(s[0]),s[1])}catch(e){console.warn("could not parse app host regex")}if(i){var r=i.replace(/[\#].*/,""),l=function(e){return e.split(/\./).slice(e.search(/\.co\.[a-z][a-z]$/)>0?-3:-2).join(".")},d=l(this.parseURLString((ENV.webSocketProto||"wss://")+r).hostname);if(l(this.parseURLString((ENV.webSocketProto||"wss://")+(n||t)).hostname)===d)return r}return n},getAppPort:function(e){var t=ENV.appPort,n=this.parseQueryString(e),a=n&&n.sp;return a?a.replace(/[\#].*/,""):t},getExtApiBaseUrl:function(){var e=ENV.extApiBaseURL;if(e&&e.indexOf("!")>=0)try{var t=e.split("!")[2],n=e.split("!")[1].split(",");e=t.replace(new RegExp(n[0]),n[1])}catch(e){console.warn("could not parse ext api base url regex")}return e},getVersionString:function(){return ENV.NPM_PKGVERSION+"-"+ENV.GIT_BRANCH+"-"+ENV.GIT_COMMITHASH},getVersionDisplayString:function(){return ENV.GIT_VERSION.replace(/^[0-9\.]+/,ENV.NPM_PKGVERSION)},getRouterBase:function(){return null},resource:function(e){return ENV.resourceBase+e},
/**!
   * Reads a 32bit base 128 variable-length integer.
   * Portions from bytebuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
   */
readVarint32:function(e,t){if(void 0===t&&(t=0),"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>e.length)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+e.length);var n,a=0,i=0;do{if(t>e.length){var o=Error("Truncated");throw o.truncated=!0,o}n=e[t++],a<5&&(i|=(127&n)<<7*a),++a}while(0!=(128&n));return{value:i|=0,length:a}},
/**!
  * Writes a 32bit base 128 variable-length integer.
  * Portions from bytebuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
  */
writeVarint32:function(e,t){var n=new Uint8Array(10);if(void 0===t&&(t=0),"number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>n.length)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+n.length);var a,i=function(e){return(e>>>=0)<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5}(e);t+=i;n.length;for(t-=i,e>>>=0;e>=128;)a=127&e|128,n[t++]=a,e>>>=7;return n[t++]=e,n.subarray(0,i)},encodeStringUint8Array:function(){
/**!
    * UTF-8 only polyfill for TextEncoder from Mozilla documentation
    * @src https://developer.mozilla.org/en-US/docs/Web/API/TextEncoder
    * portions from https://github.com/anonyco/FastestSmallestTextEncoderDecoder
    * @license CC0 1.0 Universal Public Domain
    */
var e;if("undefined"==typeof TextEncoder){(e=function(){}).prototype.encode=function(e){for(var t=e.length,n=-1,a="undefined"==typeof Uint8Array?new Array(1.5*t):new Uint8Array(3*t),i=0,o=0,s=0;s!==t;){if(i=e.charCodeAt(s),s+=1,i>=55296&&i<=56319){if(s===t){a[n+=1]=239,a[n+=1]=191,a[n+=1]=189;break}if(!((o=e.charCodeAt(s))>=56320&&o<=57343)){a[n+=1]=239,a[n+=1]=191,a[n+=1]=189;continue}if(s+=1,(i=1024*(i-55296)+o-56320+65536)>65535){a[n+=1]=240|i>>>18,a[n+=1]=128|i>>>12&63,a[n+=1]=128|i>>>6&63,a[n+=1]=128|63&i;continue}}i<=127?a[n+=1]=0|i:i<=2047?(a[n+=1]=192|i>>>6,a[n+=1]=128|63&i):(a[n+=1]=224|i>>>12,a[n+=1]=128|i>>>6&63,a[n+=1]=128|63&i)}return"undefined"!=typeof Uint8Array?a.subarray(0,n+1):(a.length=n+1,a)},e.prototype.toString=function(){return"[object TextEncoder]"};try{Object.defineProperty(e.prototype,"encoding",{get:function(){if(e.prototype.isPrototypeOf(this))return"utf-8";throw TypeError("Illegal invocation")}})}catch(t){e.prototype.encoding="utf-8"}"undefined"!=typeof Symbol&&(e.prototype[Symbol.toStringTag]="TextEncoder")}else e=TextEncoder;var t=new e;return function(e){return t.encode(e)}}(),decodeStringUint8Array:function(){var e;"undefined"==typeof TextDecoder?
/**!
      * UTF-8 only TextDecoder polyfill written in 2013 by Viktor Mukhachev
      * @copy CC0 Public Domain
      */
(e=function(){}).prototype.decode=function(e){for(var t="",n=0;n<e.length;){var a=e[n],i=0,o=0;if(a<=127?(i=0,o=255&a):a<=223?(i=1,o=31&a):a<=239?(i=2,o=15&a):a<=244&&(i=3,o=7&a),e.length-n-i>0)for(var s=0;s<i;)o=o<<6|63&(a=e[n+s+1]),s+=1;else o=65533,i=e.length-n;t+=String.fromCodePoint(o),n+=i+1}return t}:e=TextDecoder;var t=new e;return function(e){return t.decode(e)}}(),byteSize:function(e){return new Blob([e]).size},triggerShowAndHideElement:function(e){e.classList.remove("hidden"),setTimeout((function(){e&&(e.classList.add("hiding"),e.classList.add("start"))}),0),setTimeout((function(){e&&e.classList.remove("start")}),100);var t=null;t=setInterval((function(){if(e){var n=e.ownerDocument.defaultView,a=n.getComputedStyle(e).opacity,i=n.getComputedStyle(e).display;"0"!==a&&"none"!==i||(e.classList.add("hidden"),e.classList.remove("hiding"),clearInterval(t))}else clearInterval(t)}),1e3)},isPopupWindow:function(e){return(e=e||window)&&e.toolbar&&!e.toolbar.visible},generateTimeID:function(e){var t=((e=e||(new Date).getTime())+"").length,n=parseInt((Math.floor(256*Math.random())+"").padStart(3,"0")+""+e),a=t+3-(n+"").length;return n=n.toString(16),a>0&&(n=n.padStart(n.length+a,"0")),n},parseTimeID:function(e){var t=/[^0]/.exec(e).index,n="".padStart(t,"0");return parseInt((n+""+parseInt(e,16)).substring(3))},hashString:function(e,t,n){for(var a=0,i=0;i<e.length;i++)a=(a<<5)-a+e.charCodeAt(i),a&=a;return n||(a>>>=0),t&&t>0?a%t:a},RLE_Encode:function(e){for(var t=new Uint32Array(e.length),n=e[0],a=0,i=0,o=1;o<e.length;o++)if(e[o]!==n&&(t[i]=o-a,t[i+1]=n,n=e[o],a=o,(i+=2)+2>=e.length))return null;return t[i]=e.length-a,t[i+1]=n,i+2>=e.length?null:t.subarray(0,i+2)},RLE_Decode:function(e,t){for(var n=new Uint32Array(t),a=0,i=0;i<e.length;i+=2){var o=e[i],s=e[i+1];n.fill(s,a,a+o),a+=o}return n},isMobileTouch:function(e){return e=e||("object"===("undefined"==typeof window?"undefined":n(window))?window:{}),ENV.mobileTouchEnabled&&(this.UA.isAndroid||this.UA.isIOS)&&("ontouchstart"in e||e.navigator&&e.navigator.msPointerEnabled||e.navigator&&e.navigator.maxTouchPoints&&e.navigator.maxTouchPoints>=2)||!1},isIndependentScaleCSSCapable:function(e){var t=(e=e||("object"===("undefined"==typeof document?"undefined":n(document))?document:{})).createElement("div");t.style.scale="3.14";var a=e.defaultView;if(this.isNil(a))return!1;if(this.isNil(a.getComputedStyle))return!1;var i=!1;try{e.body.appendChild(t),i="3.14"===a.getComputedStyle(t).scale}catch(t){console.error(t)}finally{e.body.removeChild(t)}return i},getDPIScale:function(e,t){return!(t&&!ENV.dpiScaleSessionAuth)&&(this.UA.isAndroid||this.UA.isIOS||this.isMobileTouch(e)?ENV.dpiScaleMobileEnabled:ENV.dpiScaleEnabled)&&e&&e.devicePixelRatio||1},UA:(a=function e(t,a){var i={};i.calcUA=e,t=t||navigator.userAgent,a=a||("object"===("undefined"==typeof window?"undefined":n(window))?window:{});var o="object"===("undefined"==typeof document?"undefined":n(document))?document:{};return i.isOpera=!!a.opr&&!!opr.addons||!!a.opera||t.indexOf(" OPR/")>=0,i.isFirefox="undefined"!=typeof InstallTrigger,i.isIE=/* @cc_on!@*/!!o.documentMode||!!(t.indexOf(" Trident/")>=0),i.isEdge=!!(t.indexOf(" Edg/")>=0),i.isLegacyEdge=!!(t.indexOf(" Edge/")>=0),i.isChrome=!(!(t.indexOf("Chrome")>=0)||i.isOpera||i.isEdge||i.isLegacyEdge),i.isChromium=!!(t.indexOf("Chromium")>=0)&&!i.isOpera&&!i.isEdge,i.isWebKit=-1!=t.indexOf("WebKit"),i.isSafari="[object SafariRemoteNotification]"===(!a.safari||"undefined"!=typeof safari&&safari.pushNotification).toString()||!!(t.indexOf(" Safari/")>=0)&&!(i.isChrome||i.isChromium||i.isEdge||i.isLegacyEdge),i.isIOS=t.indexOf("iPhone")>=0||t.indexOf("iPad")>=0||t.indexOf("iPod")>=0,i.isIOSDesktopMode=!i.isIOS&&i.isSafari&&"ontouchstart"in a,i.isIOSDesktopMode&&(i.isIOS=!0),i.isAndroid=/Android/i.test(t),i.isWin=-1!=navigator.appVersion.indexOf("Win"),i.isMacOS=-1!=t.indexOf("Mac OS")&&!i.isIOS,i.isElectron=-1!=t.indexOf("Electron"),"object"===("undefined"==typeof utils?"undefined":n(utils))&&(utils.UA=i),i}(),a)}}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={id:e,loaded:!1,exports:{}};return n[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=n,i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},i.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"==typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"==typeof n.then)return n}var o=Object.create(null);i.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var r=2&a&&n;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((function(e){s[e]=function(){return n[e]}}));return s.default=function(){return n},i.d(o,s),o},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=function(e){return Promise.all(Object.keys(i.f).reduce((function(t,n){return i.f[n](e,t),t}),[]))},i.u=function(e){return"static/js/"+e+"."+{60:"52bf5369195b263733d8",182:"65a3981b0d7630b92e26",285:"785c18d13b9479ec60b3",456:"1b54c039b19aa1aca04b",720:"6cc7ea405f21a6dc1a43"}[e]+".worker.js"},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},i.p="/",function(){var e={670:1};i.f.i=function(t,n){e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunkSilo_WebClient=self.webpackChunkSilo_WebClient||[],n=t.push.bind(t);t.push=function(t){var a=t[0],o=t[1],s=t[2];for(var r in o)i.o(o,r)&&(i.m[r]=o[r]);for(s&&s(i);a.length;)e[a.pop()]=1;n(t)}}(),function(){var e,t,n=i("O9yl");try{globalThis.window="object"==typeof window?window:globalThis}catch(e){}try{globalThis.document="object"==typeof document?document:void 0}catch(e){}globalThis.translate=function(e){return e};var a=new Date,o=!0;i.e(285).then(i.bind(i,"N0Lg")).then((function(t){e=t.default,window.store=e})),i.e(720).then(i.bind(i,"74vY")).then((function(e){t=e.WindowClientList})),function(){var e={locateFile:function(){return"/"+"static/js/a8rdp/liba8rdp.wasm"},print:console.debug};window.Module=e,i.e(182).then(i.t.bind(i,"A7EY",23)).then((function(){console.debug("liba8rdp loaded"),window.liba8rdpLoadStarted=!0,window.Module.onRuntimeInitialized=function(){console.debug("liba8rdp init"),window.liba8rdpLoadFailure=!1,n.Z.isNonNil(window.pendingNewSessionDetails)&&(n.Z.isNonNil(wcl)?(console.debug("start pending session after a8rdp wasm init"),wcl.newSession({windowClient:window.pendingNewSessionDetails.windowClient,user:window.pendingNewSessionDetails.user,contextID:window.pendingNewSessionDetails.contextID,ssoDetails:window.pendingNewSessionDetails.ssoDetails}),window.pendingNewSessionDetails=null):window.pendingNewSessionDetails.windowClient.postMessage({type:"connectionClosed",closeReason:"network"}))},window.Module.onAbort=function(){console.error("liba8rdp abort"),window.liba8rdpLoadFailure=!0},window.Module.currentInstantiateAsync&&window.Module.currentInstantiateAsync.catch((function(e){console.error("liba8rdp init error"),console.error(e),window.liba8rdpLoadFailure=!0}))}))}(),globalThis.ENV=null,globalThis.wcl=null,globalThis.XMLHttpRequest=function(){this.readyState=0,this.status=0,this.method=null,this.path=null,this.onreadystatechange=function(){},this.open=function(e,t){this.method=e,this.path=t},this.send=function(){var e=this;fetch(this.path,{method:this.method,headers:{}}).then((function(t){return e.status=t.status,e.response=t,e.readyState=4,t.text()})).then((function(t){e.responseText=t,e.onreadystatechange(e)})).catch((t=>{console.error("Error:",t),e.readyState=4,e.onreadystatechange(e)}))}};var s=null;const r=n.Z.isNil(self.clients);var l={id:n.Z.generateTimeID(),postMessage:globalThis.postMessage?globalThis.postMessage.bind(globalThis):null};globalThis.updateENV=function(e){ENV===e||Object.keys(e||{}).length<=0||(ENV=n.Z.objPlus(ENV,n.Z.objRemoveDefaults(n.Z.objPlus(e,{NODE_ENV:void 0}))))};self.addEventListener("activate",(function(e){console.log("activate"),setTimeout((function(){ENV&&self.store.DB.getSessionsAndWindowClients((function(e){self.lastDBState=e,self.onLastDBState&&(self.onLastDBState(self.lastDBState),self.onLastDBState=null)}))}),400)})),self.addEventListener("install",(e=>{console.log("install"),setTimeout((function(){self.skipWaiting()}),1e3)})),self.addEventListener("message",(function(i){var d=n.Z.isNonNil(i.source)?i:{source:l,origin:i.origin,data:i.data};if(n.Z.isNonNil(i.data.fakeSource)&&(d.source=n.Z.objPlus(d.source,i.data.fakeSource),d.source.postMessage=function(e,t){return e=n.Z.objPlus(e,{fakeID:d.source.id}),l.postMessage(e,t)}),!n.Z.isNonNil(n.Z.validVal(d.origin))||d.origin===location.origin){((d.data.type||"").indexOf("jsw_")<0||self.debugA8RDP)&&"log"!==d.data.type&&"heartbeat"!==(d.data.type||"")&&"heartbeatRequest"!==(d.data.type||"")&&"heartbeatResponse"!==(d.data.type||"")&&console.debug("->|sw: "+d.data.type);var c=d.source.id;if(d.data&&"SKIP_WAITING"===d.data.type)self.skipWaiting();else{if(d.data&&"getDate"===d.data.type)return console.log(a),console.log(2),a;if(d.data&&"init"===d.data.type){s&&(clearTimeout(s),s=null),ENV?updateENV(d.data.ENV):(ENV=d.data.ENV,updateENV(d.data.ENV),!0,e.init(),r&&(self.initPageURL=d.data.url,l.url=self.initPageURL),wcl=new t(e),globalThis.serviceWorker&&"activated"===serviceWorker.state&&self.store.DB.getSessionsAndWindowClients((function(e){self.lastDBState=e,self.onLastDBState&&(self.onLastDBState(self.lastDBState),self.onLastDBState=null)}))),wcl.addWindowClient(d.source,{userAgent:d.data.userAgent,isMobileTouch:d.data.isMobileTouch,dpiScale:d.data.dpiScale}),globalThis.onStart2Timeout&&(clearTimeout(globalThis.onStart2Timeout),globalThis.onStart2Timeout=null),o&&(globalThis.onStart2Timeout=setTimeout((function(){self.onStart2()}),200))}else if(d.data&&"updateENV"===d.data.type)updateENV(d.data.ENV);else if(d.data&&"heartbeatRequest"===d.data.type)d.source.postMessage({type:"heartbeatResponse",date:Date.now()});else if(d.data&&"log"===d.data.type)wcl&&wcl.log(c,d.data.logLevel,d.data.message);else if(d.data&&"getSessions"===d.data.type){if(wcl){var u=Object.keys(wcl.getSessions());d.source.postMessage({type:"sessionList",sessions:u})}}else if(d.data&&"newSession"===d.data.type){if(!window.Module.calledRun){console.warn("liba8rdp failed to run as of newSession");var f=!0;return window.liba8rdpLoadFailure?Module.reload?(Module.reload(),window.Module.currentInstantiateAsync&&(f=!1,window.Module.currentInstantiateAsync.catch((function(e){console.error("liba8rdp init error newSession"),console.error(e),window.liba8rdpLoadFailure=!0,d.source.postMessage({type:"connectionClosed",closeReason:"network"})}))),Module.onRuntimeInitialized=function(){console.debug("liba8rdp init newSession"),window.liba8rdpLoadFailure=!1,f||(n.Z.isNonNil(wcl)?wcl.newSession({windowClient:d.source,user:d.data.user,contextID:d.data.contextID,ssoDetails:d.data.ssoDetails}):f=!0)}):(console.error("Module corrupt"),self.registration.unregister(),self.skipWaiting()):window.liba8rdpLoadStarted?(window.pendingNewSessionDetails={windowClient:d.source,user:d.data.user,contextID:d.data.contextID,ssoDetails:d.data.ssoDetails},f=!1):(console.error("Module corrupt 2"),self.registration.unregister(),self.skipWaiting()),void(f&&d.source.postMessage({type:"connectionClosed",closeReason:"network"}))}n.Z.isNonNil(wcl)?wcl.newSession({windowClient:d.source,user:d.data.user,contextID:d.data.contextID,ssoDetails:d.data.ssoDetails}):d.source.postMessage({type:"connectionClosed",closeReason:"network"})}else if(d.data&&"connectToRDP"===d.data.type){if(wcl){var p=wcl.getWC(c);if(n.Z.isNil(p))return;p.setSessionID(d.data.sessionID),p.setStreamID(d.data.streamID)}}else if(d.data&&"connectPendingRDP"===d.data.type){if(wcl){p=wcl.getWC(c);if(n.Z.isNil(p))return;if(p.active){var w=p.getStreamID();return void(parseInt(w)>=0&&p.windowClient.postMessage({type:"startRDP",streamID:w,active:p.active,slateTabs:p.slateTabs,slateExtensions:p.slateExtensions}))}if(!wcl.connectWindowClientToPendingSessionRDP(p.ID,d.data.slateTabID))return void p.windowClient.postMessage({type:"closeWindow"});w=p.getStreamID();p.windowClient.postMessage({type:"initRDP",streamID:w,slateTabs:p.slateTabs,slateExtensions:p.slateExtensions}),wcl.getAllWindowClientsForSessionID(p.getSessionID()).forEach((function(e){e.windowClient.postMessage({type:"windowLoaded",streamID:w,slateTabs:e.slateTabs,slateExtensions:e.slateExtensions})})),parseInt(w)>=0&&p.windowClient.postMessage({type:"startRDP",streamID:w,active:p.active,slateTabs:p.slateTabs,slateExtensions:p.slateExtensions})}}else if(d.data&&"connectorSend"===d.data.type){if(wcl){p=wcl.getWC(c);if(n.Z.isNonNil(p)){var g=wcl.getCli(p.ID);n.Z.isNonNil(g)&&g.fsm.connector.send(d.data.data)}}}else if(d.data&&"connectorSendClientChannel"===d.data.type){if(wcl){p=wcl.getWC(c);if(n.Z.isNonNil(p)){g=wcl.getCli(p.ID);n.Z.isNonNil(g)&&g.fsm.connector.send_client_channel(d.data.data,d.data.streamID)}}}else if(d.data&&"initRDP"===d.data.type){if(wcl){p=wcl.getWC(c);if(n.Z.isNil(p))return;p.useH264Canvas=d.data.rdpWindowDetails.useH264Canvas,p.useYUVCanvas=d.data.rdpWindowDetails.useYUVCanvas,p.width=d.data.rdpWindowDetails.width,p.height=d.data.rdpWindowDetails.height,p.dpiScale=d.data.rdpWindowDetails.dpiScale,p.isPopup=d.data.isPopup;var h=wcl.getRDPProcessor(p.ID);n.Z.isNonNil(h)&&!h.inited&&h.init({useH264Canvas:p.useH264Canvas,useYUVCanvas:p.useYUVCanvas,width:p.width,height:p.height,dpiScale:p.dpiScale})}}else if(d.data&&"jsw_start"===d.data.type){console.log("jsw_start");h=wcl.getRDPProcessor(c);if(n.Z.isNil(h)||h.started)return void console.warn("ignoring jsw_start, already started");p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.getCli(p.ID).fsm.connector.startRDP(p.getStreamID())}else if(d.data&&"jsw_delete_context"===d.data.type)console.log("jsw_delete_context");else if(d.data&&"jsw_keyboard_input"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.keyboardInput(d.data.scancode,d.data.flags)}else if(d.data&&"jsw_send_keyboard_layout"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.sendKeyboardLayout(d.data.layout)}else if(d.data&&"jsw_mouse_input"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.mouseInput(d.data.x,d.data.y,d.data.flags)}else if(d.data&&"jsw_resize_session"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.resize(d.data.width,d.data.height,d.data.scale,d.data.forceResize)}else if(d.data&&"setH264FilteringEnabled"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.setH264FilteringEnabled(d.data.enabled)}else if(d.data&&"setH264DrawEnabled"===d.data.type){h=wcl.getRDPProcessor(c);var y=d.data.enabled;n.Z.isNonNil(h)&&h.setH264DrawEnabled(y);p=wcl.getWC(c);if(n.Z.isNonNil(p)){var b=p.getSessionID();w=p.getStreamID();(S=wcl.getWindowClientsForStream(b,w)).forEach((function(e){e.ID!==p.ID&&e!==p&&e.windowClient.postMessage({type:"setH264DrawEnabled",enabled:y})}))}}else if(d.data&&"requestScreenRefresh"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.requestScreenRefresh(d.data.width,d.data.height)}else if(d.data&&"jsw_send_suppress"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.requestScreenSuppress(d.data.width,d.data.height,d.data.suppress)}else if(d.data&&"pasteClipboardString"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.pasteClipboardString(d.data.str)}else if(d.data&&"pasteClipboardImage"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.pasteClipboardImage(d.data.img)}else if(d.data&&"sendIMEString"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.sendIMEString(d.data.str)}else if(d.data&&"sendInvalidate"===d.data.type){h=wcl.getRDPProcessor(c);n.Z.isNonNil(h)&&h.sendInvalidate(d.data.x,d.data.y,d.data.cx,d.data.cy)}else if(d.data&&"beforeunload"===d.data.type){if(wcl){p=wcl.getWC(c);if(n.Z.isNonNil(p)){b=p.getSessionID();wcl.removeWindowClient(d.source,p.isEmptySlateTabs())}}}else if(d.data&&"stopSession"===d.data.type){p=wcl.getWC(c);if(n.Z.isNonNil(p)){b=p.getSessionID();if(n.Z.isNil(b))return;var S=wcl.getAllWindowClientsForSessionID(b),N=wcl.getWindowClientsForStream(b,"0");N.length<=0&&1===S.length&&(N=wcl.getWindowClientsForStream(b,"-1"));var v=N.length>0?N[0].ID:null;wcl.stopAndRemoveSession(b),S.forEach((function(e){e.resetRDP(),e.ID===v||e.windowClient.postMessage({type:"closeWindow"})}))}}else if(d.data&&"send_url_request"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.getCli(c).fsm.connector.send_url_request(d.data.data)}else if(d.data&&"send_session_action_request"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.getCli(c).fsm.connector.send_session_action_request(d.data.actions,d.data.fromUserAction,d.data.otherData)}else if(d.data&&"focus"===d.data.type)wcl.setFocus(c);else if(d.data&&"blur"===d.data.type)wcl.setBlur(c);else if(d.data&&"setVisibility"===d.data.type)wcl.setVisibility(c,d.data.visible);else if(d.data&&"updateSlateTabURL"===d.data.type)wcl.updateSlateTabURL(c,d.data.url);else if(d.data&&"slateRequestChromelessWindows"===d.data.type)wcl.requestChromelessWindows(c,d.data.enabled);else if(d.data&&"killSocket"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.getCli(c).fsm.connector._ws.close()}else if(d.data&&"getTabs"===d.data.type){d.source.postMessage({type:"updateTabs",openTabs:null})}else if(d.data&&"openSlateExtension"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.openSlateExtension(p,d.data.parentID,d.data.extensionType)}else if(d.data&&"closeSlateExtension"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.closeSlateExtension(p,d.data.ID)}else if(d.data&&"focusSlateExtension"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.focusSlateExtension(p,d.data.ID)}else if(d.data&&"moveSlateExtension"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.moveSlateExtension(p,d.data.ID,d.data.x,d.data.y)}else if(d.data&&"resizeSlateExtension"===d.data.type){p=wcl.getWC(c);n.Z.isNonNil(p)&&wcl.resizeSlateExtension(p,d.data.ID,d.data.width,d.data.height)}else if(d.data&&"manualReconnectAttempt"===d.data.type){if(n.Z.isNil(wcl))return console.warn("wcl is null in manualReconnectAttempt"),void d.source.postMessage({type:"connectionClosed",closeReason:"network"});p=wcl.getWC(c);if(n.Z.isNonNil(p)){g=wcl.getCli(c);n.Z.isNonNil(g)?g.attemptManualReconnect((function(){wcl.getAllWindowClientsForSessionID(p.getSessionID()).forEach((function(e){e.windowClient.postMessage({type:"sessionReconnectManualProgress"})}))})):(console.warn("cli is null for wc in manualReconnectAttempt"),p.windowClient.postMessage({type:"connectionClosed",closeReason:"network"}))}else console.warn("unknown wc in wcl for manualReconnectAttempt"),d.source.postMessage({type:"connectionClosed",closeReason:"network"})}else if(d.data&&"sendOOBCode"===d.data.type){p=wcl.getWC(c);if(n.Z.isNonNil(p)){g=wcl.getCli(c);n.Z.isNonNil(g)&&g.send_oob_code(d.data.code)}}else if(d.data&&"sendOOBOption"===d.data.type){p=wcl.getWC(c);if(n.Z.isNonNil(p)){g=wcl.getCli(c);n.Z.isNonNil(g)&&g.send_oob_option(d.data.device,d.data.sms,d.data.voice)}}}}})),self.onStart2=function(){console.log("SW start 2");var e=function(e){var t=e.sessions||{},n=e.windowClients||{},a=Object.keys(t||{});a.length>0&&(window.liba8rdpLoadFailure&&a.forEach((function(e){t[e].reconnect_enabled=!1})),console.log("recreate the sessions and reconnect them"),console.log(t),self.store.DB.clearSessionsAndWindowClients((function(){wcl&&wcl.reconnectSavedSessions(t,n)})))};n.Z.isNonNil(self.lastDBState)?e(self.lastDBState):self.onLastDBState=function(){e(self.lastDBState)},o=!1},"true"===n.Z.parseQueryString(self.location.search).installable&&self.addEventListener("fetch",(function(e){})),self.onStart=function(){console.log("SW start"),n.Z.isNil(self.clients)||(self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(e){(e=e||[]).forEach((function(e){e.postMessage({type:"controllerChange"})}))})),globalThis.SWHeartbeatInterval=setInterval((function(){self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(e){(e=e||[]).forEach((function(e){"visible"!=e.visibilityState&&e.postMessage({type:"heartbeatRequest",date:Date.now()})}))}))}),1e4))},self.onStart()}()}();