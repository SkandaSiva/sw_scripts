self.addEventListener('push',function(event){console.log("push",event);if(!(self.Notification&&self.Notification.permission==='granted')){return;}
const sendNotification=jdata=>{console.log(jdata);const title=jdata.title;const icon='https://estghfar.com/img/estghfar.png';return self.registration.showNotification(title,{body:jdata.body,data:{click_action:jdata.click_action},icon,});};if(event.data){const jdata=JSON.parse(event.data.text());;event.waitUntil(sendNotification(jdata));}});self.addEventListener('notificationclick',function(event){console.log(event.notification);event.notification.close();event.waitUntil(clients.matchAll({type:"window"}).then(function(clientList){for(var i=0;i<clientList.length;i++){var client=clientList[i];if(client.url=='/'&&'focus'in client)
return client.focus();}
if(clients.openWindow){console.log(event.notification.data);if(event.notification.data&&event.notification.data.click_action){return clients.openWindow(event.notification.data.click_action);}else{return clients.openWindow('https://estghfar.com/');}}}));});