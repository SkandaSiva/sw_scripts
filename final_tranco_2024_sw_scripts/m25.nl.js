const currentYear=new Date().getFullYear();const currentShortYear=currentYear.toString().substr(-2);const currentMonth=new Date().getMonth()+1;const currentDay=new Date().getDate();const staticCacheName='static-v'+currentShortYear+currentMonth+currentDay;const dynamicCacheName='dynamic-v'+currentShortYear+currentMonth+currentDay;const dynamicCacheMaxsize=250;const assets=[];const limitCacheSize=(name,size)=>{caches.open(name).then(cache=>{cache.keys().then(keys=>{if(keys.length>size){cache.delete(keys[0]).then(limitCacheSize(name,size))}})})}
self.addEventListener('install',evt=>{evt.waitUntil(caches.open(staticCacheName).then(cache=>{cache.addAll(assets)}))});self.addEventListener('activate',evt=>{evt.waitUntil(caches.keys().then(keys=>{return Promise.all(keys.filter(key=>key!==staticCacheName&&key!==dynamicCacheName).map(key=>caches.delete(key)))}))});self.addEventListener('fetch',evt=>{if(evt.request.url.indexOf('https://cdn.websumo.')!==-1){return!1}
if(evt.request.url.indexOf('https://www.websumo.')===-1){return!1}
evt.respondWith(caches.match(evt.request).then(cacheRes=>{return cacheRes||fetch(evt.request).then(fetchRes=>{return caches.open(dynamicCacheName).then(cache=>{if(evt.request.url.match(/\.(ico|pdf|flv|jpg|jpeg|png|gif|js|css|swf|thumb|eot|otf|ttf|woff|woff2)/)){cache.put(evt.request.url,fetchRes.clone());limitCacheSize(dynamicCacheName,dynamicCacheMaxsize)}
return fetchRes})})}).catch(()=>{if(evt.request.url.indexOf('.html')>-1){return caches.match('/fallback')}}))})